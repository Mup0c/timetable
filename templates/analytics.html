<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="UTF-8">
    <title>I have paws</title>
     <style type="text/css">
        TABLE {
            border-collapse: collapse;
            border: 2px solid #b0e0e6;
            border-right: 0px;
            border-left: 0px;
        }
        TD, TH {
            padding: 4px;
            border: 3px solid black;
        }
        TH {
            background: #b0e0e6;
        }
        .names{
            border: 0px;
        }
        .data{
            width: 400px;
            border: 0px;
        }

     </style>
  </head>
  <body>
     <form>
        <input type="hidden" name="wasSubmitted" value={{ wasSubmitted }}>
        <a>Строка: </a>
        <select name="row" onchange="wasSubmitted.value=0;this.form.submit()">
           {% for i in range(viewedNames | length) %}
              <option {% if selected_row==i %} selected {% endif %} value = {{i}}>
                 {{ viewedNames[i] }}
              </option>
           {% endfor %}
        </select>
        <br><br>
        <a>Столбец: </a>
        <select name="col" onchange="wasSubmitted.value=0;this.form.submit()">
           {% for i in range(viewedNames | length) %}
              <option {% if selected_col==i %} selected {% endif %}  value = {{i}}>
                 {{ viewedNames[i] }}
              </option>
           {% endfor %}
        </select>
        <br><br>
        <input type="submit" value="Показать" onclick="wasSubmitted.value=1">
        <br><br>
        <a>Скрыть:</a>
        <br>
        {% for i in range(viewedNames | length) %}
            <input type="checkbox" name="{{i}}" value="0" {% if not i in showed_cols %} checked {% endif %}>
            <a> {{ viewedNames[i]}} </a>
            <br>
        {% endfor %}
        <a>Скрыть заголовки: </a>
        <input type="checkbox" name="showNames" value="0" {% if showNames==0 %} checked {% endif %}>
        <br><br>
        {% for cond in search.conditions %}
           <select name={{'c' + cond.order}}>
              {% for field in meta %}
                 <option {% if cond.column.colName==field.colName %} selected {% endif %} value="{{ field.colName }}">
                    {{ field.viewedName }}
                 </option>
              {% endfor %}
           </select>
           <select name={{'op' + cond.order}}>
              {% for operator in operators %}
                 <option {% if cond.operator==operator %} selected {% endif %}>
                    {{ operator }}
                 </option>
              {% endfor %}
            </select>
           <input name={{'s' + cond.order}} value="{{ cond.request }}">
        <br><br>
        {% endfor %}
        <input type="hidden" name="cnt" value="{{search.count}}">
        <input type="submit" value="Добавить" onclick="cnt.value={{search.count + 1}};wasSubmitted.value=1">
        {% if search.count > 1 %}
        <input type="submit" value="Удалить" onclick="cnt.value={{search.count - 1}}">
        {% endif %}
        <br><br>
        <table>
           <tr>
           <th></th>
           {% if viewed_table|length > 0 %}
           {% for key in viewed_table.copy().popitem()[1].keys() %}
              <th align="center">
                 {{ key }}
              </th>
           {% endfor %}
           {% endif %}
           </tr>
           {% for key, dict in viewed_table.items() %}
              <tr>
              <th align="center">
                {{ key }}
              </th>
              {% for value in dict.values() %}
                 <td>
                    <br>
                    {% if not value is none %}
                    {% for list in value %}
                    <table>
                       {% for i in showed_cols %}
                       <tr>
                          {% if showNames == 1 %}
                          <td class="names">
                             {{ viewedNames[i] }}
                          </td>
                          {% endif %}
                          <td class="data" {% if showNames == 0 %} align="center" {%endif%}>
                             {{ list[i] }}
                          </td>
                       </tr>
                       {% endfor %}
                    </table>
                    <br>
                    {% endfor %}
                    {% endif %}
                 </td>
              {% endfor %}
              </tr>
           {% endfor %}
        </table>
     </form>
  </body>
</html>